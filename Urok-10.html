<!DOCTYPE html>
<html lang="uk">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Рядкові функції в PHP</title>
   <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
   <div class="post-content">
      <h2>Текстові (Рядкові) функції</h2>
      Для Web розробки найголовнішим інструментом є рядки та функції їх обробки.<br><a data-fancybox="gallery"
         href="assets/img/ryadkovi-funkcii-v-php.jpg">
         <img src="assets/img/ryadkovi-funkcii-v-php.jpg" alt="Рядкові функції в PHP" title="Рядкові функції в PHP" />
      </a>
      <h2>Рядки як масиви</h2>У мові програмування РНР рядки розглядаються як масиви, елементами яких є символи. Перший
      елемент позначається індексом 0, другий – 1 і т.д.
      <pre><code>&lt;?php<br>$str = 'PHP';<br>echo $str[0]; // P<br>echo $str[1]; // H<br>echo $str[2]; // P</code></pre>
      Результатом роботи скрипта буде рядок «РНР».<h2>UTF-8. Розширення mbstring</h2>Сьогодні кодування <i>UTF-8</i> є
      базовим для додатків. Перехід на <i>UTF-8</i> не тільки дозволяє використовувати в одному документі тексти різними
      мовами, але й дозволяє розширити кодування при появі нових символів. Починаючи з РНР 7 символи кодування
      <i>UTF-8</i> можуть бути задані за допомогою спеціального синтаксису, в рядках вказується послідовність <i>\u</i>,
      після якої слідує шістнадцятковий код символу у фігурних дужках:
      <pre><code>&lt;?php<br>echo "\u{0410}"; // A</code></pre>У <i>UTF-8</i> англійські символи займають один байт, а
      українські – два. Якщо звернутися до <i>UTF-8</i> рядка, як до масиву символів, використовуючи квадратні дужки, у
      разі англійської мови буде отримано символ, а в разі української – лише половина символу:
      <pre><code>&lt;?php<br>$str = "Hello world";<br>echo "{$str[0]}&lt;br /&gt;"; // H<br>$str = "Привіт світ!";<br>echo "{$str[0]}&lt;br /&gt;"; // �</code></pre>
      Для вирішення проблеми, як правило, підключають розширення <i>Mbstring</i>, що підтримує роботу з багатобайтними
      кодуваннями, використовують функції <i>Mbstring</i> безпосередньо, або налаштовують РНР таким чином, щоб
      стандартні рядкові функції РНР замінювалися mbstring-аналогами. Як підключити бібліотеку Mbstring можна дізнатися
      із статті: <a href="blogs/9151" target="_blank">Встановлення вебсервера Apache 2.4 з модулем
         PHP 8</a>.<h2>Функції для роботи із символами</h2>Щоб дізнатися довжину рядка використовується функція <a
         href="https://www.php.net/manual/en/function.strlen" target="_blank">Strlen</a>, яка приймає єдиним аргументом
      рядок символів. Ця функція часто використовується спільно з іншими функціями, а також під час роботи з
      посимвольним представленням рядка. У наступному прикладі в циклі <i>For</i> виводиться рядок <i>$str</i>, що
      містить слово <i>Hello</i>. Скрипт опирається на той факт, що елемент <i>$str[0]</i> містить перший символ рядка,
      <i>$str[1]</i> другий і т. д. до кінця рядка:
      <pre><code>&lt;?php<br>$str = 'Hello';<br>for ($i = 0; $i &lt; strlen($str); $i++) {<br>    echo $str[$i];<br>}</code></pre>
      Функція <a href="https://www.php.net/manual/en/function.chr" target="_blank">Chr</a> приймає аргументом
      <i>ASCII</i>-код символу і повертає відповідний цьому коду фактичний символ. Наведемо приклад використання функції
      для отримання символу з кодом 45:
      <pre><code>&lt;?php<br>echo chr(45); // -</code></pre>Функція <a href="https://www.php.net/manual/en/function.ord"
         target="_blank">Ord</a> виконує дію, зворотню функції <i>Chr</i> - повертає <i>ASCII</i>-код символу,
      переданого їй як аргумент:
      <pre><code>&lt;?php<br>echo ord('-'); // 45</code></pre>Якщо параметр <i>$str</i> функції <i>Ord</i> містить
      більше одного символу, ASCII-код буде повернено лише для першого.<h2>Пошук у рядку</h2>Функція <a
         href="https://www.php.net/manual/en/function.substr" target="_blank">Substr</a> повертає частину рядка
      (підрядок). Аргументами функції передається вихідний рядок, з якого вирізається текст, номер символу, з якого
      здійснюється початок підрядка і довжина рядка, що повертається в символах. Якщо довжина не вказана, то
      повертається вся частина рядка, що залишилася.
      <pre><code>&lt;?php<br>$str = 'Hello, World!';<br>echo substr($str, 0, 5); // Hello<br>echo substr($str, 6); // World!</code></pre>
      Функція <a href="https://www.php.net/manual/en/function.strpos" target="_blank">Strpos</a> повертає позицію
      входження підрядка в рядок. У першому аргументі функції передається рядок, у якому здійснюється пошук, другим
      аргументом вказується символ пошуку. Також третій необов’язковий параметр дозволяє задати позицію, починаючи з
      якої здійснюватиметься пошук. Якщо рядок не знайдено, повертається <i>False</i>.
      <pre><code>&lt;?php<br>echo strpos('Hello, world!', ','); // 5</code></pre>
      <h2>Заміна у тексті</h2>Функції заміни здійснюють перетворення рядків, пов’язані із заміною одних підрядоків на
      інші, а також видаленням підрядків. Найчастіше використовують функцію <a
         href="https://www.php.net/manual/en/function.str-replace" target="_blank">Str_replace</a>, яка дозволяє
      замінити підрядок у тексті іншим підрядком. Аргументами функції виступають шукане значення, значення заміни та
      рядок, в якому замінюються всі входження. Одним з найпоширеніших завдань є заміна тегів форматування в стилі
      <i>bbCode</i> їх НТМL-еквівалентами:
      <pre><code>&lt;?php<br>$str = '[і]Текст[/і] курсивом';<br>$str = str_replace('[і]', '&lt;і&gt;', $str);<br>$str = str_replace('[/і]', '&lt;/і&gt;', $str);<br>echo $str; // Текст курсивом<br></code></pre>
      Результатом роботи прикладу буде заміна всіх символів і <i>&lt;i&gt;</i> і <i>&lt;/i&gt;</i>
      відповідно.<br><br>Крім підрядків, функція <i>Str_replace</i> замість параметрів пошуку та заміни може приймати
      масиви з рівною кількістю елементів. Елемент масиву пошуку замінюється на відповідний елемент масиву заміни. Якщо
      необхідно з’ясувати, скільки замін було здійснено в рядку, у цій функції можна вказати необов’язковий останній
      четвертий параметр, у який після завершення роботи функції буде поміщено кількість здійснених
      замін.<br><br>Функція <a href="https://www.php.net/manual/en/function.trim" target="_blank">Trim</a> видаляє
      початкові та кінцеві пробільні символи з початку та кінця рядка і приймає як аргумент рядок. Найчастіше даних
      символів буває недостатньо, тому у другому необов’язковому параметрі наводиться список символів, які слід вважати
      пробільними.<h2>Робота з НТМL-кодом</h2>Оскільки спочатку РНР розроблялася як мова для Web-проектування, тому
      серед рядкових функцій є кілька спеціально призначених для обробки мови розмітки HTML.<br><br>Для виведення даних
      з нового рядка застосовується спеціальний НТМL-тег <i>&lt;br /&gt;</i>, оскільки браузери інтерпретують переводи
      рядків як звичайний пробіловий символ. Для вирішення завдання заміни звичайних переводів рядків у НТМL-еквівалент
      РНР надає спеціальну функцію <a href="https://www.php.net/manual/en/function.nl2br"
         target="_blank">Nl2br</a>.<br><br>Особливість функції <i>Nl2br</i> в тому, що тег <i>&lt;br /&gt;</i>
      вставляється поруч із символом переводу рядка, а не замінює його собою. Така поведінка функції може бути не
      зручною, якщо текст призначений для підстановки у JavaScript cpипт. У цьому випадку зручніше користуватися
      функцією <i>Str_replace</i>.<br><br>Функція <a href="https://www.php.net/manual/en/function.htmlspecialchars"
         target="_blank">Htmlspecialchars</a> дозволяє перетворити НТМL-код у безпечне представлення. Застосування цієї
      функції гарантує, що будь-який введений користувачем код (РНР, JavaScript тощо) буде відображений, але не
      виконуватиметься. Таким чином, функцію слід застосовувати, якщо необхідно вивести у браузері якийсь код або
      убезпечити введення користувача.<br><br>Іноді зручніше взагалі видалити НТМL-теги з тексту. Для цього призначена
      спеціальна функція <a href="https://www.php.net/manual/en/function.strip-tags" target="_blank">Strip_tags</a>, яка
      видаляє з рядка всі теги, крім тих, які вказуються в другому параметрі функції.<h2>Форматний вивід</h2>Для
      форматного виводу призначено функцію <a href="https://www.php.net/manual/en/function.printf"
         target="_blank">Printf</a>. Аргументами функції є рядок форматування та змінні, що визначаються рядком
      форматування. Ця функція дозволяє здійснювати вивід у зручну і потрібну для вас форму, наприклад, можна
      використовувати для виведення певної кількості символів після коми для грошових одиниць, де обов’язковою вимогою є
      два знаки після коми.<h2>Об’єднання та розбиття рядків</h2>Для розбивки рядка за певним роздільником призначено
      функцію <a href="https://www.php.net/manual/en/function.explode" target="_blank">Explode</a>, яка повертає масив
      рядків, кожен з яких відповідає фрагменту вихідного рядка між роздільниками. Можна задати максимальну кількість
      елементів у результуючому масиві, і, відповідно, в останньому елементі буде зберігатися значення частини рядка, що
      залишилася. Наведемо приклад використання функції:
      <pre><code>&lt;?php<br>$str = 'Red,Green,Yellow';<br>echo '&lt;pre&gt;';<br>print_r(explode(',', $str));</code></pre>
      Результатом виконання буде масив:
      <pre><code>Array<br>(<br>    [0] =&gt; Red<br>    [1] =&gt; Green<br>    [2] =&gt; Yellow<br>)</code></pre>Функція
      <a href="https://www.php.net/manual/en/function.implode" target="_blank">Implode</a> є зворотною функцією
      <i>Explode</i> і здійснює об’єднання елементів масиву в рядок:
      <pre><code>&lt;?php<br>$str = ['Red,Green,Yellow'];<br>print_r(implode(',', $str)); // Red,Green,Yellow</code></pre>
      Часто в HTML потрібно обмежити кількість символів на одному рядку, тобто занадто довге слово або речення може
      порушити дизайн сторінки. Для цього призначено функцію <a href="https://www.php.net/manual/en/function.wordwrap"
         target="_blank">Wordwrap</a>, яка здійснює перенесення на задану кількість символів з використанням символу
      розриву рядка. Але використовувати її для кодування <i>UTF-8</i> не рекомендується, оскільки можливим є
      неправильний результат роботи.<h2>Серіалізація об’єктів та масив</h2>Пара функцій <a
         href="https://www.php.net/manual/en/function.serialize" target="_blank">Serialize</a> і <a
         href="https://www.php.net/manual/en/function.unserialize" target="_blank">Unserialize</a> дозволяють
      здійснювати упаковку та розпакування масивів та об’єктів.<br><br>Як аргумент функція <i>Serialize</i> приймає
      масив або об’єкт, повертаючи його як закодований рядок. Симетрична їй функція <i>Unserialize</i> приймає як
      аргумент закодований рядок, повертаючи масив чи об’єкт. Продемонструємо приклад використання обох функцій:
      <pre><code>&lt;?php<br>$array = [1, 2, 'a', 'b', 'c'];<br>// Упаковуємо масив у рядок<br>$str = serialize($array);<br>echo "$str&lt;br /&gt;";<br>// Виймаємо масив з рядка<br>$arr = unserialize($str);<br>echo '&lt;pre&gt;';<br>print_r($arr);</code></pre>
      Результатом роботи прикладу будуть наступні рядки:
      <pre><code>a:5:{i:0;i:1;i:1;i:2;i:2;s:1:"a";i:3;s:1:"b";i:4;s:1:"c";}<br>Array<br>(<br>    [0] =&gt; 1<br>    [1] =&gt; 2<br>    [2] =&gt; a<br>    [3] =&gt; b<br>    [4] =&gt; c<br>)</code></pre>
      <h2>JSON-формат</h2>Процедура серіалізації має кілька недоліків. При спробі серіалізувати вже серіалізовані дані,
      відновити рядок за допомогою функції <i>Unserialize</i> може не вийти. Тому для збереження масиву в рядок частіше
      вдаються до формату <i>JSON</i>, який останніми роками набув великої популярності серед Web-розробників. Формат є
      об’єктом <i>JavaScript</i>. Однією з переваг цього формату є його легке сприйняття людиною. Формат дозволяє
      задавати рядкові, числові значення, організовувати вкладені структури, аналогічні до асоціативних масивів
      РНР.<br><br>У мові <i>JavaScript</i>, <i>JSON</i> може використовуватися безпосередньо як об’єкт мови. Завдяки
      цьому формат інтенсивно застосовується для асинхронних АJАХ-запитів. У РНР доступні дві функції для роботи з JSON:
      <a href="https://www.php.net/manual/en/function.json-encode" target="_blank">Json_encode</a> та <a
         href="https://www.php.net/manual/en/function.json-decode" target="_blank">Json_decode</a>.<br><br>Функція
      <i>Json_encode</i> перетворює змінну, яка вказана в параметрі функції, в послідовність <i>JSON</i>.
      <pre><code>&lt;?php<br>$arr = [<br>    'color' =&gt; 'Жовтий',<br>    'num' =&gt; [<br>        '123',<br>        '456'<br>    ]<br>];<br>echo json_encode($arr);</code></pre>
      Результат роботи скрипту з наведеного вище прикладу:
      <pre><code>{"color":"\u0416\u0435\u043b\u0442\u044b\u0439","num":["123","456"]}</code></pre>За замовчуванням
      функція <i>Json_encode</i> кодує символи <i>UTF-8</i> у послідовність <i>\uXXXX</i>. Щоб запобігти такому
      кодуванню, потрібно налаштувати роботу функції за допомогою другого параметра, який може приймати певні константи
      <i>JSON</i>. Нам потрібна константа <i>JSON_UNESCAPED_UNICODE</i> для того, щоб запобігти кодуванню <i>UTF-8</i>,
      який і так чудово обробляється всіма іншими мовами, включаючи JavaScript.
      <pre><code>echo json_encode($arr, JSON_UNESCAPED_UNICODE); //{"color":"Жовтий","num":["123","456"]}</code></pre>
      Для перетворення JSON-рядка в масив РНР призначена функція <i>Json_decode</i>, яка приймає як параметр JSON-рядок
      і повертає асоціативний масив РНР, якщо значення другого параметра функції виставлено в <i>True</i>:
      <pre><code>&lt;?php<br>$str = '{"color":"Жовтий","num":["123","456"]}';<br>print_r(json_decode($str, true));</code></pre>
      Результат виконання прикладу виглядає так:
      <pre><code>Array<br>(<br>    [color] =&gt; Жовтий<br>    [num] =&gt; Array<br>        (<br>            [0] =&gt; 123<br>            [1] =&gt; 456<br>        )<br><br>)</code></pre>
      Якщо значення цього параметра виставлено в <i>False</i> або не вказано, повертається об’єкт.<br><br>
   </div>


   <div class="task">
      <br>
      Завдання:<br>
      1) замінити текст в змінній на інший<br>
      2) зробити пошук у рядку<br>
      3) розбити текст в масив<br>
      3) обєднати масив в рядок<br>
      4) спробувати json_decode і json_encode<br>
      5) пройтись по вивченному матеріалові
      <br>
      <br>
   </div>

</body>

</html>